javascript:/* v1.0.0 */(()=>{const e=(()=>{try{return trustedTypes.createPolicy("g_trustPolicy",{createHTML:e=>e})}catch(e){return{createHTML:e=>e}}})(),t=()=>{document.querySelector("#k_kugi_style")?.remove(),document.head.insertAdjacentHTML("beforeend",e.createHTML("\n<style id=\"k_kugi_style\">\n.k_kuten {\n\tdisplay: inline!important;\n\tfloat: unset!important;\n\tposition: static!important;\n\tfont-weight: bold;\n\tborder-radius: 4px;\n\tmargin-inline-start: 2px;\n\tmargin-inline-end: 4px;\n}\n.k_touten {\n\tdisplay: inline!important;\n\tfloat: unset!important;\n\tposition: static!important;\n\tfont-weight: bold;\n\tmargin-inline-start: 2px;\n\tmargin-inline-end: 8px;\n}\n.k_kuten.k_dark_color {\n\tcolor: #ddd;\n\tbackground: #464646;\n\tborder: 1px #ddd dashed;\n}\n.k_touten.k_dark_color {\n\tcolor: #ddd;\n\tbackground: #5e5e5e;\n}\n.k_kuten.k_light_color,.k_touten.k_light_color {\n\tcolor: #333;\n\tbackground: #ccc;\n\tborder: 1px #333 dashed;\n}\n.k_br {\n\tdisplay: block;\n\theight: 1px;\n\tfloat: unset!important;\n}\n.k_space1,.k_space2,.k_space3,.k_space4 {\n\tdisplay: inline!important;\n\tposition: static!important;\n\tpadding: 0!important;\n}\n.k_space_error:before {\n\tcontent: '　';\n}\n.k_space1:before {\n\tcontent: '　';\n}\n.k_space2:before {\n\tcontent: '　　';\n}\n.k_space3:before {\n\tcontent: '　　　';\n}\n.k_space4:before {\n\tcontent: '　　　　';\n}\n.k_kuten_br {\n\tcontent: \"\";\n\tdisplay: block;\n\tposition: relative;\n\theight: 0.75rem;\n}\n.k_kuten_br:before {\n\tcontent: \"+\";\n\tposition: absolute;\n\tcolor: #afafaf;\n\ttop:50%;\n\ttransform: translateY(-50%);\n\ttext-indent: 2rem;\n\tfont-size: x-small;\n}\n.k_kuten_br.k_light_color:before {\n\tcolor: #ccc;\n}\n.k_kakko_l, .k_kakko_r {\n\tdisplay: inline!important;\n\tfont-size: inherit!important;\n\tposition: static!important;\n}\n.k_kakko_l.k_dark_color {\n\tbackground-color: #94ffff;\n\tmargin-inline-start: 1px;\n\tmargin-inline-end: 2px;\n}\n.k_kakko_r.k_dark_color {\n\tbackground-color: #c8ff70;\n\tmargin-inline-start: 2px;\n\tmargin-inline-end: 1px;\n}\n.k_kakko_l.k_light_color {\n\tbackground-color: DarkSlateGray;\n\tmargin-inline-start: 1px;\n\tmargin-inline-end: 2px;\n}\n.k_kakko_r.k_light_color {\n\tbackground-color: #3c3909;\n\tmargin-inline-start: 2px;\n\tmargin-inline-end: 1px;\n}\n.k_noDisp {\n\tdisplay: none;\n}\n.k_space_error {\n\tbackground-color: red;\n}\n\ndd {\n\tmargin-block-end: 0.75rem;\n}\nbody {\n\tline-height: 1.5;\n}\n</style>"))},n=(t,n)=>{const s=document.createElement("div");s.innerHTML=e.createHTML(n),t.after(...s.childNodes),t.remove()},s=e=>{const t=e.e_base?.getBoundingClientRect().top;!e.e_base||Math.abs(t-e.n_base_top)<50||scrollTo(0,document.documentElement.scrollTop+t-e.n_base_top)};console.time(),(()=>{const a=(()=>{const e=[...document.querySelectorAll("*")].filter((e=>{const t=e.getBoundingClientRect();return 0!==t.width&&t.top>=0&&t.top<document.documentElement.clientHeight/2&&(e=>{for(;e;){if(!["static","relative"].includes(getComputedStyle(e).position))return!1;e=e.parentElement}return!0})(e)}))[0];return{e_base:e,n_base_top:e?.getBoundingClientRect().top}})();if(document.querySelector("#k_kugi_style"))return(()=>{const e=document.querySelector("#k_kugi_style");e.firstChild?e.replaceChildren():t()})(),void s(a);t(),(()=>{const t=(e,t)=>e.matches(".k_kuten,.k_touten,.k_br,.k_space1,.k_space2,.k_space3,.k_space4,.k_kuten_br,.k_kakko_l,.k_kakko_r")||t.get(e).checkVisibility,s=(e,t)=>e.matches(".k_kuten,.k_touten,.k_kakko_l,.k_kakko_r")?"inline":t.get(e).display,a=(e,t)=>{let n=e;for(;n;){switch(n.nodeType){case Node.ELEMENT_NODE:if(["STYLE","SCRIPT","NOSCRIPT","LINK","SUP","RUBY","RB","RP","RT"].includes(n.tagName))break;return n;case Node.TEXT_NODE:if(!n.textContent.match(/^\s*$/u))return n}for(;!n.nextSibling&&!t.has(n.parentElement);)n=n.parentElement;n=n.nextSibling}return null},o=(e,t)=>{let n=e;for(;!n.nextSibling&&!t.has(n.parentElement);)n=n.parentElement;return n=n.nextSibling,a(n,t)},l=(e,t)=>{const{color:n}=t.get(e),[s,a,o]=n.match(/(\d+)/gu);return.2126*s+.7152*a+.0722*o>127.5},r=e=>{if(!e)return!1;if(e.nodeType!==Node.ELEMENT_NODE)return!1;const t=e.classList.values();let n;for(;n=t.next(),!n.done;)if(n.value.startsWith("k_kakko"))return!0;return!1},c=(e,t)=>{if(!e)return!1;switch(e.nodeType){case Node.ELEMENT_NODE:return!!e.classList.contains("k_br")||"BR"===e.tagName;case Node.TEXT_NODE:return!(!e.textContent.match(/\n/u)||!e.textContent.match(/^\s+$/u)||"pre-wrap"!==t.get(e.parentElement).whiteSpace);default:return!1}},i=e=>{let t=e;for(;t;){if(t.nodeType!==Node.ELEMENT_NODE)return!1;if("IMG"===t.tagName)return!0;t=t.firstChild}return!1},k=e=>!!e&&e.nodeType===Node.ELEMENT_NODE&&!!["H1","H2","H3","H4","H5","H6","HGROUP"].includes(e.tagName),p=(e,t)=>{if(["IFRAME","TEXTAREA","FORM"].includes(e.tagName))return!0;const n=s(e,t);return"block"===n?e===document.body||"inline-flex"!==s(e.parentElement,t):["list-item","table","table-row","table-cell","flex","grid","-webkit-box"].includes(n)},d=(e,t)=>!!e&&e.nodeType===Node.ELEMENT_NODE&&!(e=>{if(!e)return!1;if(e.nodeType!==Node.ELEMENT_NODE)return!1;const t=e.classList.values();let n;for(;n=t.next(),!n.done;)if(n.value.startsWith("k_space"))return!0;return!1})(e)&&!c(e)&&p(e,t),u=(()=>{const e=new Map,t=document.createNodeIterator(document.body,NodeFilter.SHOW_ELEMENT);let n;for(;n=t.nextNode();){const t=getComputedStyle(n);e.set(n,{display:t.display,whiteSpace:t.whiteSpace,flexDirection:t.flexDirection,color:t.color,float:t.float,checkVisibility:n.checkVisibility({checkVisibilityCSS:!0})})}return e})(),_=(e=>{const t=new Set,n=document.createNodeIterator(document.body,NodeFilter.SHOW_ELEMENT,(e=>e.closest("BR,SCRIPT,STYLE,NAV,NOSCRIPT,FOOTER,ASIDE,LINK,CANVAS,IMG,HR,EMBED,OBJECT,CODE,RT,H1,H2,H3,H4,H5,H6,HGROUP")?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT));let a;for(;a=n.nextNode();){if("none"!==e.get(a).float)continue;const n=s(a,e);"block"===n?a!==document.body&&"inline-flex"===s(a.parentElement,e)||t.add(a):"list-item"===n&&t.add(a)}return t})(u);((e,s)=>{const a=e=>{const t={"&":"&amp;","<":"&lt;",">":"&gt;"};return e.replaceAll(/[&<>]/gu,(e=>t[e]))},l=e=>"）)".includes(e)?e:`<span class="k_kakko_r">${e}</span>`,r=(()=>{const e=document.createNodeIterator(document.body,NodeFilter.SHOW_TEXT),n=[];let a;for(;a=e.nextNode();)a.parentElement.closest(".k_kuten,.k_touten,BR,SCRIPT,STYLE,NAV,NOSCRIPT,FOOTER,ASIDE,LINK,CANVAS,IMG,HR,EMBED,OBJECT,CODE,TEXTAREA,IFRAME")||t(a.parentElement,s)&&n.push(a);return n})();for(let t=0;t<r.length;t++)c=r[t],i=e,"pre-wrap"===s.get(c.parentElement).whiteSpace?((e,t)=>{const r=e.textContent,c=/(([。、]+|[？！]+)|[「」｢｣《》『』＜＞])|\n+/gu;let i,k=0,p="";for(;i=c.exec(r);){const n=r.slice(k,i.index);n&&(p+=a(n));const u=i[0];if("\n".includes(u[0]))p+=`${u}<span class="k_br k_noDisp"></span>`;else if("「｢《『＜".includes(u[0]))p+=`<span class="k_kakko_l">${u}</span>`;else if("」｣》』＞".includes(u[0]))p+=`<span class="k_kakko_r">${u}</span>`;else if("。？！".includes(u[0])){const n=e.parentElement.closest("H1,H2,H3,H4,H5,H6,HGROUP,RT"),a=r[c.lastIndex];if(n)p+=`<span class="k_kuten">${u}</span>`;else if(a&&"）)」｣》』＞".includes(a)){c.lastIndex++;const n=r.slice(c.lastIndex);if(n.match(/^[ \t]*$/u)){const n=o(e,t),r=!(!n||n.nodeType!==Node.ELEMENT_NODE||"BR"!==n.tagName)&&n;if(n)if(r){p+=`<span class="k_kuten">${u}</span>${l(a)}`;const e=o(r,t);e&&e.nodeType===Node.ELEMENT_NODE&&"BR"===e.tagName||r.classList.add("k_kuten_br")}else d(n,s)?p+=`<span class="k_kuten">${u}</span>${l(a)}`:p+=`<span class="k_kuten">${u}</span>${l(a)}<span class="k_br"></span>`;else p+=`<span class="k_kuten">${u}</span>${l(a)}`}else n[0]&&"。、？！".includes(n[0])?p+=`<span class="k_kuten">${u}</span>${l(a)}`:p+=`<span class="k_kuten">${u}</span>${l(a)}<span class="k_br"></span>`}else if(r.slice(c.lastIndex).match(/^[ \t]*$/u)){const n=o(e,t),a=!(!n||n.nodeType!==Node.ELEMENT_NODE||"BR"!==n.tagName)&&n;if(n)if(a){p+=`<span class="k_kuten">${u}</span>`;const e=o(a,t);e&&e.nodeType===Node.ELEMENT_NODE&&"BR"===e.tagName||a.classList.add("k_kuten_br")}else d(n,s)||n.textContent.match(/^\s*[）)」｣》』＞]/u)?p+=`<span class="k_kuten">${u}</span>`:p+=`<span class="k_kuten">${u}</span><span class="k_br"></span>`;else p+=`<span class="k_kuten">${u}</span>`}else r.slice(c.lastIndex).match(/^((?!\n).)*?\S/su)?p+=`<span class="k_kuten">${u}</span><span class="k_br"></span>`:p+=`<span class="k_kuten">${u}</span><span class="k_br k_noDisp"></span>`}else p+=`<span class="k_touten">${u}</span>`;k=c.lastIndex}p?(k!==r.length&&(p+=a(r.slice(k))),p=p.replaceAll(/<span class="k_br k_noDisp"><\/span>(?=\n)/gu,""),n(e,p)):e.textContent!==r&&(e.textContent=a(r))})(c,i):((e,t)=>{const r=e.textContent,c=/(([。、]+|[？！]+)|[「」｢｣《》『』＜＞])/gu;let i,k=0,p="";for(;i=c.exec(r);){const n=r.slice(k,i.index);n&&(p+=a(n));const u=i[0];if("「｢《『＜".includes(u[0]))p+=`<span class="k_kakko_l">${u}</span>`;else if("」｣》』＞".includes(u[0]))p+=`<span class="k_kakko_r">${u}</span>`;else if("。？！".includes(u[0])){const n=e.parentElement.closest("H1,H2,H3,H4,H5,H6,HGROUP,RT"),a=r[c.lastIndex];if(n)p+=`<span class="k_kuten">${u}</span>`;else if(a&&"）)」｣》』＞".includes(a)){c.lastIndex++;const n=r.slice(c.lastIndex);if(n.match(/^[ \t\n]*$/u)){const n=o(e,t),r=!(!n||n.nodeType!==Node.ELEMENT_NODE||"BR"!==n.tagName)&&n;if(n)if(r){p+=`<span class="k_kuten">${u}</span>${l(a)}`;const e=o(r,t);e&&e.nodeType===Node.ELEMENT_NODE&&"BR"===e.tagName||r.classList.add("k_kuten_br")}else d(n,s)?p+=`<span class="k_kuten">${u}</span>${l(a)}`:p+=`<span class="k_kuten">${u}</span>${l(a)}<span class="k_br"></span>`;else p+=`<span class="k_kuten">${u}</span>${l(a)}`}else n[0]&&"。、？！".includes(n[0])?p+=`<span class="k_kuten">${u}</span>${l(a)}`:p+=`<span class="k_kuten">${u}</span>${l(a)}<span class="k_br"></span>`}else if(r.slice(c.lastIndex).match(/^[ \t\n]*$/u)){const n=o(e,t),a=!(!n||n.nodeType!==Node.ELEMENT_NODE||"BR"!==n.tagName)&&n;if(n)if(a){p+=`<span class="k_kuten">${u}</span>`;const e=o(a,t);e&&e.nodeType===Node.ELEMENT_NODE&&"BR"===e.tagName||a.classList.add("k_kuten_br")}else d(n,s)||n.textContent.match(/^\s*[）)」｣》』＞]/u)?p+=`<span class="k_kuten">${u}</span>`:p+=`<span class="k_kuten">${u}</span><span class="k_br"></span>`;else p+=`<span class="k_kuten">${u}</span>`}else p+=`<span class="k_kuten">${u}</span><span class="k_br"></span>`}else p+=`<span class="k_touten">${u}</span>`;k=c.lastIndex}p?(k!==r.length&&(p+=a(r.slice(k))),n(e,p)):e.textContent!==r&&(e.textContent=a(r))})(c,i);var c,i})(_,u),((e,t)=>{const n=e.keys();let s;for(;s=n.next(),!s.done;){const e=s.value;if("pre-wrap"===t.get(e).whiteSpace)continue;const n=e.firstChild;n&&n.nodeType===Node.TEXT_NODE&&n.textContent.match(/^\s*$/u)&&n.remove()}})(_,u),((n,l)=>{const u=e=>{let t;if(e<0)return console.log(`0未満の値は予期されません。n_括弧_sum = ${e}`),'<span class="k_space_error"></span>';switch(e){case 0:t='<span class="k_space1"></span>';break;case 1:t='<span class="k_space2"></span>';break;case 2:t='<span class="k_space3"></span>';break;default:t='<span class="k_space4"></span>'}return t},_=e=>{const t=(e,t)=>{const n=new RegExp(`[${t}]`,"gu"),s=e.match(n);return s?.length??0},n=(e,n)=>{let s=0;for(let a=0;a<n.length;a++){const o=n[a];s+=t(e,o)}return s};return n(e,"（(「｢《『＜")-n(e,"）)」｣》』＞")},E=e=>{let t=e.previousSibling;for(;t;){switch(t.nodeType){case Node.TEXT_NODE:if(!t.textContent.match(/^\s*$/u))return!1;break;case Node.ELEMENT_NODE:if(!["STYLE","SCRIPT","NOSCRIPT","LINK"].includes(t.tagName))return!1}t=t.previousSibling}return!0},f=(e,t)=>{let n=e.parentElement;for(;n;){if(!E(e))return!1;if(t.has(n))return!0;e=n,n=n.parentElement}return!1},m=document.createNodeIterator(document.body,NodeFilter.SHOW_ALL,(function(e){return e.nodeType===Node.TEXT_NODE?e.parentElement.closest("SCRIPT,STYLE,NAV,NOSCRIPT,FOOTER,ASIDE,LINK,CANVAS,IMG,HR,EMBED,OBJECT,CODE,TEXTAREA,IFRAME")?NodeFilter.FILTER_REJECT:t(e.parentElement,l)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT:c(e,l)||k(e)?t(e,l)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT:void 0})),N=[];let T;for(;T=m.nextNode();)N.push(T);let g="",b=0;e:for(let t=0;t<N.length;t++){const E=N[t];if(E.nodeType===Node.TEXT_NODE)if(f(E,n)){const t=a(E,n);if(t&&t.nodeType===Node.ELEMENT_NODE&&d(t,l)){g+=E.textContent;continue}if(E.textContent.match(/^\s*$/u)){g+=E.textContent;continue}let o=E.parentElement;for(;o&&!n.has(o);){if(p(o,l)){g+=E.textContent;continue e}o=o.parentElement}o=o??E.parentElement;const c=o===document.body?null:o.parentElement;if(c&&("flex"===s(c,l)&&"row"===l.get(c).flexDirection||"grid"===s(c,l))){g+=E.textContent;continue}b+=_(g),b=b<0?0:b,g=E.textContent;let i=E.parentElement;for(;r(i);)i=i.parentElement;i.insertAdjacentHTML("afterbegin",e.createHTML(u(b)))}else if(d(E.previousSibling,l)){const t=E.parentElement;if(t&&["flex","grid"].includes(s(t,l))){g+=E.textContent;continue}if(E.textContent.match(/^\s*$/u)){g+=E.textContent;continue}if(E.previousSibling.textContent.match(/^\s*$/u)){g+=E.textContent;continue}b+=_(g),b=b<0?0:b,g=E.textContent,E.previousSibling.insertAdjacentHTML("afterend",e.createHTML(u(b)))}else g+=E.textContent;else if(k(E))g="",b=0;else{const t=o(E,n);if(!t)continue;if(c(t,l))continue;if(t&&t.nodeType===Node.ELEMENT_NODE&&p(t,l))continue;if(i(t))continue;b+=_(g),b=b<0?0:b,g="",E.insertAdjacentHTML("afterend",e.createHTML(u(b)))}}})(_,u),(()=>{const e=e=>{const t=e.classList.values();let n;for(;n=t.next(),!n.done;){const e=n.value.match(/^k_space(\d+)$/u);if(e)return e[1]}},t=document.querySelectorAll(".k_space1,.k_space2,.k_space3,.k_space4");for(let n=0;n<t.length;n++){const s=t[n],a=s.nextSibling;if(a&&a.nodeType===Node.TEXT_NODE&&a.textContent.match(/^[ \t\n　]/u)){const t=e(s);switch(t){case"1":a.textContent=a.textContent.replace(/^[ \t\n]*　{0,1}/u,"");break;case"2":a.textContent=a.textContent.replace(/^[ \t\n]*　{0,2}/u,"");break;case"3":a.textContent=a.textContent.replace(/^[ \t\n]*　{0,3}/u,"");break;case"4":a.textContent=a.textContent.replace(/^[ \t\n]*　{0,4}/u,"");break;default:console.log(`switchにおいて予期されない値です。n_space=${t}`)}}}})(),(e=>{const t=document.querySelectorAll(".k_kuten,.k_touten,.k_kuten_br,.k_kakko_l,.k_kakko_r");for(let n=0;n<t.length;n++){const s=t[n];s.classList.contains("k_light_color")||s.classList.contains("k_dark_color")||(l(s.parentElement,e)?s.classList.add("k_light_color"):s.classList.add("k_dark_color"))}})(u)})(),s(a)})(),console.timeEnd()})();